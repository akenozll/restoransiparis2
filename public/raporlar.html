<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raporlar - Restoran Sipariş Sistemi</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div>
                    <h1><i class="fas fa-chart-line"></i> Satış & Gelir Raporları</h1>
                    <p>Detaylı satış analizi ve gelir takibi</p>
                </div>
                <div class="header-actions">
                    <span class="user-info" id="userInfo">Kullanıcı</span>
                    <a href="/" class="btn btn-secondary">
                        <i class="fas fa-home"></i> Ana Sayfa
                    </a>
                </div>
            </div>
        </div>

        <!-- Filtreler -->
        <div class="section">
            <h3><i class="fas fa-filter"></i> Rapor Filtreleri</h3>
            <div class="filter-controls">
                <div class="filter-group">
                    <label>Zaman Aralığı:</label>
                    <select id="timeRange">
                        <option value="today">Bugün</option>
                        <option value="week">Bu Hafta</option>
                        <option value="month" selected>Bu Ay</option>
                        <option value="year">Bu Yıl</option>
                        <option value="custom">Özel Aralık</option>
                    </select>
                </div>
                <div class="filter-group" id="customDateRange" style="display: none;">
                    <label>Başlangıç:</label>
                    <input type="date" id="startDate">
                    <label>Bitiş:</label>
                    <input type="date" id="endDate">
                </div>
                <div class="filter-group">
                    <label>Rapor Tipi:</label>
                    <select id="reportType">
                        <option value="sales">Satış Raporu</option>
                        <option value="revenue">Gelir Raporu</option>
                        <option value="products">Ürün Analizi</option>
                        <option value="tables">Masa Analizi</option>
                        <option value="all">Tüm Raporlar</option>
                    </select>
                </div>
                <button class="btn btn-primary btn-large" onclick="generateReport()">
                    <i class="fas fa-sync-alt"></i> Rapor Oluştur
                </button>
            </div>
        </div>

                 <!-- Özet Kartları -->
         <div class="summary-cards">
             <div class="summary-card">
                 <div class="summary-icon">
                     <i class="fas fa-shopping-cart"></i>
                 </div>
                 <div class="summary-content">
                     <h4>Toplam Sipariş</h4>
                     <div class="summary-value" id="totalOrders">0</div>
                 </div>
             </div>
             <div class="summary-card">
                 <div class="summary-icon">
                     <i class="fas fa-lira-sign"></i>
                 </div>
                 <div class="summary-content">
                     <h4>Toplam Gelir</h4>
                     <div class="summary-value" id="totalRevenue">0.00 TL</div>
                 </div>
             </div>
             <div class="summary-card">
                 <div class="summary-icon">
                     <i class="fas fa-utensils"></i>
                 </div>
                 <div class="summary-content">
                     <h4>Ortalama Sipariş</h4>
                     <div class="summary-value" id="averageOrder">0.00 TL</div>
                 </div>
             </div>
             <div class="summary-card">
                 <div class="summary-icon">
                     <i class="fas fa-users"></i>
                 </div>
                 <div class="summary-content">
                     <h4>Aktif Masalar</h4>
                     <div class="summary-value" id="activeTables">0</div>
                 </div>
             </div>
         </div>
        <!-- Temizlik Butonu Bölümü -->
        <div style="text-align:right; margin: 20px 0;">
            <button id="clearDataBtn" class="btn btn-danger">
                <i class="fas fa-broom"></i> Verileri Temizle
            </button>
        </div>
        <!-- Temizlik Modalı / Popup -->
        <div class="modal" id="clearDataModal" style="display:none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Verileri Temizle</h3>
                </div>
                <div class="modal-body">
                    <p><b>Dikkat!</b> Bu işlemin geri dönüşü yoktur. Temizlenecek verileri seçin.</p>
                    <form id="clearSelections">
                        <label><input type="checkbox" id="clearOrders" checked> Tüm Siparişler</label><br>
                        <label><input type="checkbox" id="clearRevenue"> Gelir & Ciro (Sadece raporlama eklentisi tuttuysa)</label><br>
                        <label><input type="checkbox" id="clearProductStats"> Ürün Satış İstatistikleri</label><br>
                        <label><input type="checkbox" id="clearMenu"> Tüm Ürünleri Sil (Menüyü Sıfırla)</label><br>
                        <span style="font-size:0.9em;color:#444;">Tüm yemek ve içecek ürünlerini sıfırlar.</span>
                    </form>
                    <div style="margin-top:16px; padding:10px; border-radius:8px; background:#fff3cd; color:#856404; border:1px solid #ffeeba; text-align:center; font-weight:600;">
                        <i class="fas fa-exclamation-triangle"></i> Emin misiniz? Bu veriler geri getirilemez!
                    </div>
                    <div id="clearMsg" style="margin-top:10px; text-align:center; font-weight:bold;"></div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-danger" id="confirmClearData" disabled>Onayla ve Temizle</button>
                    <button class="btn btn-secondary" id="cancelClearData">İptal</button>
                </div>
            </div>
        </div>

        <!-- Grafik -->
        <div class="report-sales">
            <div class="section">
                <h3><i class="fas fa-chart-bar"></i> Satış Grafiği</h3>
                <div class="chart-container">
                    <canvas id="salesChart"></canvas>
                </div>
            </div>
        </div>
        <div class="report-revenue">
            <div class="summary-cards" id="summary-cards">
                <!-- ... gelir kartları ... -->
            </div>
        </div>
        <!-- Ürün Analizi -->
        <div class="report-products">
            <div class="section">
                <h3><i class="fas fa-chart-pie"></i> En Çok Satan Ürünler</h3>
                <div class="product-analysis">
                    <div class="chart-container">
                        <canvas id="topProductsChart"></canvas>
                    </div>
                    <div class="product-list" id="topProductsList"></div>
                </div>
            </div>
        </div>
        <!-- Masa Analizi -->
        <div class="report-tables">
            <div class="section">
                <h3><i class="fas fa-chair"></i> Masa Performansı</h3>
                <div class="table-performance" id="tablePerformance"></div>
            </div>
        </div>
        <!-- Tüm Raporlar (optionally wrapper) -->
        <div class="report-all" style="display:none;"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="raporlar.js"></script>
</body>
</html>
